/**
 * Sightline WebAR UI V2 - Design System
 * 3-Tier Progressive Disclosure System
 * - Center-Lock Card (Tier 1): Full details when aligned
 * - Side Chips (Tier 2): Compact hints in peripheral vision
 * - Edge Arrows (Tier 3): Off-screen POI indicators
 */

/* ============================================
   DESIGN TOKENS
   ============================================ */

:root {
  /* Colors - Card Backgrounds */
  --sightline-bg-card: rgba(250, 250, 250, 0.95);
  --sightline-bg-chip: rgba(255, 255, 255, 0.85);
  --sightline-bg-arrow: rgba(0, 0, 0, 0.7);
  
  /* Colors - Text */
  --sightline-text-primary: #111;
  --sightline-text-secondary: #555;
  --sightline-text-distance: #007AFF;
  --sightline-text-light: #FFF;
  
  /* Colors - UI Elements */
  --sightline-leader-line: #222;
  --sightline-shadow: rgba(0, 0, 0, 0.15);
  --sightline-border: rgba(0, 0, 0, 0.08);
  --sightline-border-chip: rgba(0, 0, 0, 0.06);
  
  /* Category Colors */
  --category-landmark: #FF6B35;
  --category-museum: #6B4FBB;
  --category-transport: #007AFF;
  --category-nature: #34C759;
  
  /* Spacing */
  --space-xs: 4px;
  --space-sm: 8px;
  --space-md: 12px;
  --space-lg: 16px;
  --space-xl: 24px;
  
  /* Typography */
  --font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
  --font-size-title: 18px;
  --font-size-body: 14px;
  --font-size-caption: 11px;
  --font-size-chip: 12px;
  --line-height-title: 1.2;
  --line-height-body: 1.4;
  --line-height-caption: 1.3;
  
  /* Timing & Easing */
  --duration-fast: 150ms;
  --duration-base: 200ms;
  --duration-slow: 300ms;
  --easing-standard: cubic-bezier(0.4, 0.0, 0.2, 1);
  --easing-decelerate: cubic-bezier(0.0, 0.0, 0.2, 1);
  --easing-accelerate: cubic-bezier(0.4, 0.0, 1, 1);
  
  /* Dimensions */
  --card-width: 280px;
  --card-height: 160px;
  --chip-width: 120px;
  --chip-height: 48px;
  --arrow-width: 80px;
  --arrow-height: 32px;
  --icon-size-card: 32px;
  --icon-size-chip: 24px;
  --icon-size-arrow: 16px;
  --tap-target: 44px;
  
  /* Z-Index Layers */
  --z-edge-arrow: 80;
  --z-side-chip: 90;
  --z-center-card: 100;
  --z-mini-map: 110;
}

/* ============================================
   TIER 1: CENTER-LOCK CARD
   ============================================ */

.center-lock-card {
  position: fixed;
  width: var(--card-width);
  height: var(--card-height);
  left: 50%;
  top: 40%;
  transform: translate(-50%, -50%);
  z-index: var(--z-center-card);
  
  background: var(--sightline-bg-card);
  backdrop-filter: blur(12px);
  -webkit-backdrop-filter: blur(12px);
  
  border: 1px solid var(--sightline-border);
  border-radius: 12px;
  box-shadow: 0 8px 24px var(--sightline-shadow);
  
  padding: var(--space-lg);
  font-family: var(--font-family);
  
  /* Smooth transitions */
  transition: opacity var(--duration-base) var(--easing-standard),
              transform var(--duration-base) var(--easing-standard);
}

.center-lock-card.entering {
  animation: cardEnter var(--duration-base) var(--easing-decelerate);
}

.center-lock-card.exiting {
  animation: cardExit var(--duration-fast) var(--easing-accelerate);
}

@keyframes cardEnter {
  from {
    opacity: 0;
    transform: translate(-50%, -50%) scale(0.95);
  }
  to {
    opacity: 1;
    transform: translate(-50%, -50%) scale(1);
  }
}

@keyframes cardExit {
  from {
    opacity: 1;
    transform: translate(-50%, -50%) scale(1);
  }
  to {
    opacity: 0;
    transform: translate(-50%, -50%) scale(0.98);
  }
}

/* Card Header */
.center-lock-card__header {
  display: flex;
  align-items: flex-start;
  justify-content: space-between;
  margin-bottom: var(--space-md);
}

.center-lock-card__icon {
  width: var(--icon-size-card);
  height: var(--icon-size-card);
  flex-shrink: 0;
  margin-right: var(--space-sm);
}

.center-lock-card__title-group {
  flex: 1;
  min-width: 0; /* Allow text truncation */
}

.center-lock-card__title {
  font-size: var(--font-size-title);
  font-weight: 700;
  line-height: var(--line-height-title);
  color: var(--sightline-text-primary);
  margin: 0 0 var(--space-xs) 0;
  
  /* Max 2 lines with ellipsis */
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
  overflow: hidden;
  text-overflow: ellipsis;
}

.center-lock-card__save-btn {
  width: var(--tap-target);
  height: var(--tap-target);
  flex-shrink: 0;
  
  background: transparent;
  border: none;
  border-radius: 50%;
  cursor: pointer;
  
  display: flex;
  align-items: center;
  justify-content: center;
  
  transition: background var(--duration-fast) var(--easing-standard),
              transform var(--duration-fast) var(--easing-standard);
}

.center-lock-card__save-btn:hover {
  background: rgba(0, 0, 0, 0.05);
}

.center-lock-card__save-btn:active {
  transform: scale(0.95);
}

.center-lock-card__save-btn svg {
  width: 20px;
  height: 20px;
}

/* Card Body */
.center-lock-card__context {
  font-size: var(--font-size-body);
  line-height: var(--line-height-body);
  color: var(--sightline-text-secondary);
  margin: 0 0 var(--space-md) 0;
  
  /* Max 1 line with ellipsis */
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

/* Card Footer */
.center-lock-card__footer {
  display: flex;
  justify-content: flex-end;
  align-items: center;
}

.center-lock-card__distance {
  display: inline-block;
  padding: var(--space-xs) var(--space-md);
  background: rgba(0, 122, 255, 0.1);
  border-radius: 16px;
  
  font-size: var(--font-size-body);
  font-weight: 600;
  color: var(--sightline-text-distance);
}

/* ============================================
   TIER 2: SIDE CHIPS
   ============================================ */

.side-chip {
  position: fixed;
  width: var(--chip-width);
  height: var(--chip-height);
  z-index: var(--z-side-chip);
  
  background: var(--sightline-bg-chip);
  backdrop-filter: blur(8px);
  -webkit-backdrop-filter: blur(8px);
  
  border: 1px solid var(--sightline-border-chip);
  border-radius: 8px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
  
  padding: var(--space-sm);
  font-family: var(--font-family);
  
  cursor: pointer;
  
  display: flex;
  align-items: center;
  gap: var(--space-sm);
  
  transition: opacity var(--duration-base) var(--easing-standard),
              transform var(--duration-base) var(--easing-standard);
}

.side-chip.entering {
  animation: chipEnter var(--duration-base) var(--easing-decelerate);
}

.side-chip.exiting {
  animation: chipExit var(--duration-fast) var(--easing-accelerate);
}

@keyframes chipEnter {
  from {
    opacity: 0;
    transform: translateX(-20px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}

@keyframes chipExit {
  from {
    opacity: 1;
    transform: translateX(0);
  }
  to {
    opacity: 0;
    transform: translateX(-10px);
  }
}

/* Right-side chips slide from opposite direction */
.side-chip.side-right.entering {
  animation: chipEnterRight var(--duration-base) var(--easing-decelerate);
}

.side-chip.side-right.exiting {
  animation: chipExitRight var(--duration-fast) var(--easing-accelerate);
}

@keyframes chipEnterRight {
  from {
    opacity: 0;
    transform: translateX(20px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}

@keyframes chipExitRight {
  from {
    opacity: 1;
    transform: translateX(0);
  }
  to {
    opacity: 0;
    transform: translateX(10px);
  }
}

.side-chip:hover {
  transform: scale(1.05);
}

.side-chip:active {
  transform: scale(0.98);
}

.side-chip__icon {
  width: var(--icon-size-chip);
  height: var(--icon-size-chip);
  flex-shrink: 0;
}

.side-chip__content {
  flex: 1;
  min-width: 0;
}

.side-chip__name {
  font-size: var(--font-size-chip);
  font-weight: 600;
  line-height: 1.2;
  color: var(--sightline-text-primary);
  margin: 0 0 2px 0;
  
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.side-chip__distance {
  font-size: var(--font-size-caption);
  line-height: var(--line-height-caption);
  color: var(--sightline-text-distance);
  margin: 0;
}

/* ============================================
   TIER 3: EDGE ARROWS
   ============================================ */

.edge-arrow {
  position: fixed;
  width: var(--arrow-width);
  height: var(--arrow-height);
  z-index: var(--z-edge-arrow);
  
  background: var(--sightline-bg-arrow);
  border-radius: 16px;
  
  padding: var(--space-xs) var(--space-sm);
  font-family: var(--font-family);
  
  cursor: pointer;
  
  display: flex;
  align-items: center;
  justify-content: center;
  gap: var(--space-xs);
  
  transition: opacity var(--duration-base) var(--easing-standard);
  
  /* Pulse animation */
  animation: arrowPulse 1s ease-in-out infinite;
}

@keyframes arrowPulse {
  0%, 100% {
    opacity: 0.7;
  }
  50% {
    opacity: 1;
  }
}

.edge-arrow.entering {
  animation: arrowEnter var(--duration-fast) var(--easing-decelerate),
             arrowPulse 1s ease-in-out infinite;
}

.edge-arrow.exiting {
  animation: arrowExit 100ms var(--easing-accelerate);
}

@keyframes arrowEnter {
  from {
    opacity: 0;
  }
  to {
    opacity: 0.7;
  }
}

@keyframes arrowExit {
  from {
    opacity: 0.7;
  }
  to {
    opacity: 0;
  }
}

.edge-arrow:hover {
  opacity: 1 !important;
  animation: none;
}

.edge-arrow__chevron {
  width: var(--icon-size-arrow);
  height: var(--icon-size-arrow);
  flex-shrink: 0;
}

.edge-arrow__text {
  font-size: var(--font-size-caption);
  font-weight: 500;
  line-height: var(--line-height-caption);
  color: var(--sightline-text-light);
  margin: 0;
  
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

/* ============================================
   LEADER LINES (A-Frame entities)
   ============================================ */

.leader-line {
  /* Styled via A-Frame line component */
  /* See ui-components.js for implementation */
}

/* ============================================
   CATEGORY STYLING
   ============================================ */

.category-landmark .center-lock-card__icon,
.category-landmark .side-chip__icon {
  color: var(--category-landmark);
}

.category-museum .center-lock-card__icon,
.category-museum .side-chip__icon {
  color: var(--category-museum);
}

.category-transport .center-lock-card__icon,
.category-transport .side-chip__icon {
  color: var(--category-transport);
}

.category-nature .center-lock-card__icon,
.category-nature .side-chip__icon {
  color: var(--category-nature);
}

/* ============================================
   MINI-MAP (Stubbed for V2)
   ============================================ */

#mini-map {
  display: none; /* V2 feature */
  position: fixed;
  top: 80px;
  right: 16px;
  width: 100px;
  height: 100px;
  z-index: var(--z-mini-map);
  
  background: rgba(255, 255, 255, 0.3);
  border: 1px solid rgba(0, 0, 0, 0.1);
  border-radius: 50%;
  
  transition: opacity var(--duration-base) var(--easing-standard);
}

/* ============================================
   ACCESSIBILITY
   ============================================ */

/* Respect reduced motion preference */
@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }
}

/* High contrast mode support */
@media (prefers-contrast: high) {
  :root {
    --sightline-bg-card: rgba(255, 255, 255, 1);
    --sightline-bg-chip: rgba(255, 255, 255, 1);
    --sightline-text-primary: #000;
    --sightline-text-secondary: #000;
    --sightline-border: rgba(0, 0, 0, 0.3);
  }
}

/* Focus visible for keyboard navigation */
.center-lock-card__save-btn:focus-visible,
.side-chip:focus-visible,
.edge-arrow:focus-visible {
  outline: 2px solid var(--sightline-text-distance);
  outline-offset: 2px;
}

/* ============================================
   RESPONSIVE ADJUSTMENTS
   ============================================ */

@media (max-width: 375px) {
  :root {
    --card-width: 260px;
    --card-height: 140px;
    --chip-width: 100px;
    --chip-height: 44px;
  }
}

@media (max-height: 667px) {
  .center-lock-card {
    top: 35%;
  }
}

/* ============================================
   UTILITY CLASSES
   ============================================ */

.hidden {
  display: none !important;
}

.invisible {
  opacity: 0 !important;
  pointer-events: none !important;
}

/* Screen reader only */
.sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border-width: 0;
}

