<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Sightline WebAR - Works Anywhere</title>
  <meta name="description" content="Discover Hong Kong landmarks through augmented reality">
  
  <!-- A-Frame + AR.js -->
  <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
  <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
  
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  
  <!-- Loading overlay -->
  <div id="loading-overlay">
    <div class="loading-content">
      <div class="spinner"></div>
      <h2>Initializing AR...</h2>
      <p id="loading-status">Requesting permissions...</p>
      <button id="skip-loading" style="
        margin-top: 20px;
        padding: 10px 20px;
        background: rgba(255,255,255,0.2);
        color: #fff;
        border: 2px solid rgba(255,255,255,0.5);
        border-radius: 8px;
        font-size: 14px;
        cursor: pointer;
        display: none;
      ">Skip & Try Demo Mode</button>
      <p style="font-size: 12px; margin-top: 10px; color: rgba(255,255,255,0.6);">
        Stuck? Try <a href="debug.html" style="color: #4ADE80;">Debug Tool</a>
      </p>
    </div>
  </div>
  
  <!-- Control Bar (Demo Mode) -->
  <div id="control-bar">
    <div class="control-row">
      <div class="control-group">
        <label class="switch">
          <input type="checkbox" id="mode-toggle">
          <span class="slider"></span>
        </label>
        <span class="control-label">Demo Mode</span>
      </div>
      
      <div class="control-group">
        <select id="preset-picker">
          <option value="">Choose preset...</option>
          <option value="freespace">ğŸŒŠ West Kowloon Freespace</option>
          <option value="tst-promenade">ğŸ—¼ TST Promenade</option>
          <option value="central-piers">â›´ï¸ Central Piers</option>
        </select>
      </div>
    </div>
    
    <div class="control-row control-row-collapsed" id="manual-controls">
      <input type="number" id="manual-lat" placeholder="Lat" step="0.0001" />
      <input type="number" id="manual-lng" placeholder="Lng" step="0.0001" />
      <input type="number" id="manual-heading" placeholder="Hdg Â°" min="0" max="359" />
      <button id="apply-manual" class="btn-apply">Apply</button>
    </div>
  </div>
  
  <!-- GPS accuracy indicator -->
  <div id="gps-info">
    <div id="gps-accuracy">GPS: Waiting...</div>
    <div id="gps-coords">Lat: --, Lng: --</div>
  </div>
  
  <!-- POI counter -->
  <div id="poi-counter">
    <span id="poi-count">0</span> landmarks nearby
  </div>
  
  <!-- Help button -->
  <button id="help-button" class="help-btn" aria-label="Help">?</button>
  
  <!-- Onboarding Coach -->
  <div id="onboarding-coach" class="hidden">
    <div class="coach-content">
      <p id="coach-message"></p>
      <button id="coach-next" class="btn-coach">Next</button>
    </div>
  </div>
  
  <!-- Empty State (no POIs in view) -->
  <div id="empty-state" class="hidden">
    <div class="empty-content">
      <p>ğŸ” No landmarks in view</p>
      <p class="empty-hint">Turn toward the harbour or choose a Preset</p>
    </div>
  </div>
  
  <!-- Ghost Hints (off-screen POIs) -->
  <div id="ghost-hints"></div>
  
  <!-- Instructions modal -->
  <div id="instructions" class="hidden">
    <div class="instructions-content">
      <h3>Welcome to Sightline AR</h3>
      <ul>
        <li>ğŸ“ <strong>Live GPS Mode:</strong> Walk to landmarks (Clock Tower, Star Ferry, etc.)</li>
        <li>ğŸ­ <strong>Demo Mode:</strong> Preview from anywhere without GPS</li>
        <li>ğŸ‘€ Point your camera at the skyline to see AR overlays</li>
        <li>ğŸ™ï¸ Cards show name, year, distance, and description</li>
        <li>â†”ï¸ Turn slowly to discover more landmarks</li>
        <li>âš™ï¸ Toggle mode in top control bar</li>
      </ul>
      <p class="tip">ğŸ’¡ <strong>Tip:</strong> Try West Kowloon Freespace preset for the best skyline view!</p>
      <button id="close-instructions" class="btn-close">Got it!</button>
    </div>
  </div>
  
  <!-- A-Frame Scene (Live GPS Mode) -->
  <a-scene
    id="ar-scene"
    vr-mode-ui="enabled: false"
    arjs="sourceType: webcam; debugUIEnabled: false; videoTexture: true;"
    renderer="logarithmicDepthBuffer: true; precision: medium;"
    embedded
    gesture-detector
  >
    
    <!-- Clock Tower (Original) -->
    <a-entity 
      gps-entity-place="latitude: 22.2946; longitude: 114.1699"
      data-poi-id="clock-tower"
      class="poi-card"
    >
      <a-plane 
        position="0 0 0" 
        width="8" 
        height="4" 
        color="#ffffff" 
        opacity="0.95"
      ></a-plane>
      
      <a-text 
        value="Clock Tower" 
        color="#000000" 
        align="center" 
        width="7" 
        position="0 1 0.01"
        font="roboto"
      ></a-text>
      
      <a-text 
        value="Former railway terminus â€¢ 1915" 
        color="#666666" 
        align="center" 
        width="6" 
        position="0 -0.5 0.01"
      ></a-text>
      
      <a-text 
        class="distance-text"
        value="---" 
        color="#3b82f6" 
        align="center" 
        width="6" 
        position="0 -1.5 0.01"
      ></a-text>
      
      <a-circle 
        radius="0.8" 
        color="#3b82f6" 
        position="3 1.5 0.01"
      ></a-circle>
      
      <a-text 
        value="1915" 
        color="#ffffff" 
        align="center" 
        width="3" 
        position="3 1.5 0.02"
      ></a-text>
    </a-entity>
    
    <!-- Star Ferry TST (Original) -->
    <a-entity 
      gps-entity-place="latitude: 22.2937; longitude: 114.1703"
      data-poi-id="star-ferry-tst"
      class="poi-card"
    >
      <a-plane width="8" height="4" color="#ffffff" opacity="0.95"></a-plane>
      <a-text value="Star Ferry (TST)" color="#000000" align="center" width="7" position="0 1 0.01"></a-text>
      <a-text value="Iconic ferry since 1888" color="#666666" align="center" width="6" position="0 -0.5 0.01"></a-text>
      <a-text class="distance-text" value="---" color="#ef4444" align="center" width="6" position="0 -1.5 0.01"></a-text>
      <a-circle radius="0.8" color="#ef4444" position="3 1.5 0.01"></a-circle>
      <a-text value="1888" color="#ffffff" align="center" width="3" position="3 1.5 0.02"></a-text>
    </a-entity>
    
    <!-- Avenue of Stars (Original) -->
    <a-entity 
      gps-entity-place="latitude: 22.2930; longitude: 114.1730"
      data-poi-id="avenue-stars"
      class="poi-card"
    >
      <a-plane width="8" height="4" color="#ffffff" opacity="0.95"></a-plane>
      <a-text value="Avenue of Stars" color="#000000" align="center" width="7" position="0 1 0.01"></a-text>
      <a-text value="HK film industry tribute" color="#666666" align="center" width="6" position="0 -0.5 0.01"></a-text>
      <a-text class="distance-text" value="---" color="#3b82f6" align="center" width="6" position="0 -1.5 0.01"></a-text>
      <a-circle radius="0.8" color="#3b82f6" position="3 1.5 0.01"></a-circle>
      <a-text value="2004" color="#ffffff" align="center" width="3" position="3 1.5 0.02"></a-text>
    </a-entity>
    
    <!-- IFC Tower (Skyline - Far Field) -->
    <a-entity 
      gps-entity-place="latitude: 22.2855; longitude: 114.1588"
      data-poi-id="ifc"
      class="poi-card poi-far"
    >
      <a-plane width="15" height="8" color="#ffffff" opacity="0.95"></a-plane>
      <a-text value="IFC Tower" color="#000000" align="center" width="14" position="0 2 0.01" font="roboto"></a-text>
      <a-text value="International Finance Centre â€¢ 412m" color="#666666" align="center" width="12" position="0 0 0.01"></a-text>
      <a-text class="distance-text" value="---" color="#3b82f6" align="center" width="12" position="0 -2 0.01"></a-text>
      <a-circle radius="1.2" color="#3b82f6" position="6 3 0.01"></a-circle>
      <a-text value="2003" color="#ffffff" align="center" width="4" position="6 3 0.02"></a-text>
    </a-entity>
    
    <!-- ICC (Skyline - Far Field) -->
    <a-entity 
      gps-entity-place="latitude: 22.3069; longitude: 114.1617"
      data-poi-id="icc"
      class="poi-card poi-far"
    >
      <a-plane width="15" height="8" color="#ffffff" opacity="0.95"></a-plane>
      <a-text value="ICC" color="#000000" align="center" width="14" position="0 2 0.01"></a-text>
      <a-text value="International Commerce Centre â€¢ 484m" color="#666666" align="center" width="12" position="0 0 0.01"></a-text>
      <a-text class="distance-text" value="---" color="#3b82f6" align="center" width="12" position="0 -2 0.01"></a-text>
      <a-circle radius="1.2" color="#3b82f6" position="6 3 0.01"></a-circle>
      <a-text value="2010" color="#ffffff" align="center" width="4" position="6 3 0.02"></a-text>
    </a-entity>
    
    <!-- M+ Museum -->
    <a-entity 
      gps-entity-place="latitude: 22.3030; longitude: 114.1605"
      data-poi-id="mplus"
      class="poi-card"
    >
      <a-plane width="8" height="4" color="#ffffff" opacity="0.95"></a-plane>
      <a-text value="M+ Museum" color="#000000" align="center" width="7" position="0 1 0.01"></a-text>
      <a-text value="Visual culture museum" color="#666666" align="center" width="6" position="0 -0.5 0.01"></a-text>
      <a-text class="distance-text" value="---" color="#8b5cf6" align="center" width="6" position="0 -1.5 0.01"></a-text>
      <a-circle radius="0.8" color="#8b5cf6" position="3 1.5 0.01"></a-circle>
      <a-text value="2021" color="#ffffff" align="center" width="3" position="3 1.5 0.02"></a-text>
    </a-entity>
    
    <!-- Xiqu Centre -->
    <a-entity 
      gps-entity-place="latitude: 22.3049; longitude: 114.1689"
      data-poi-id="xiqu"
      class="poi-card"
    >
      <a-plane width="8" height="4" color="#ffffff" opacity="0.95"></a-plane>
      <a-text value="Xiqu Centre" color="#000000" align="center" width="7" position="0 1 0.01"></a-text>
      <a-text value="Chinese opera & performance" color="#666666" align="center" width="6" position="0 -0.5 0.01"></a-text>
      <a-text class="distance-text" value="---" color="#ec4899" align="center" width="6" position="0 -1.5 0.01"></a-text>
      <a-circle radius="0.8" color="#ec4899" position="3 1.5 0.01"></a-circle>
      <a-text value="2019" color="#ffffff" align="center" width="3" position="3 1.5 0.02"></a-text>
    </a-entity>
    
    <!-- Star Ferry Central -->
    <a-entity 
      gps-entity-place="latitude: 22.2820; longitude: 114.1586"
      data-poi-id="star-ferry-central"
      class="poi-card"
    >
      <a-plane width="8" height="4" color="#ffffff" opacity="0.95"></a-plane>
      <a-text value="Star Ferry (Central)" color="#000000" align="center" width="7" position="0 1 0.01"></a-text>
      <a-text value="Central pier terminal" color="#666666" align="center" width="6" position="0 -0.5 0.01"></a-text>
      <a-text class="distance-text" value="---" color="#ef4444" align="center" width="6" position="0 -1.5 0.01"></a-text>
      <a-circle radius="0.8" color="#ef4444" position="3 1.5 0.01"></a-circle>
      <a-text value="1888" color="#ffffff" align="center" width="3" position="3 1.5 0.02"></a-text>
    </a-entity>
    
    <!-- Camera with GPS -->
    <a-camera 
      gps-camera="minDistance: 5; maxDistance: 5000; simulateLatitude: 0; simulateLongitude: 0;"
      rotation-reader
      look-controls-enabled="false"
    ></a-camera>
    
  </a-scene>
  
  <script src="app.js"></script>
</body>
</html>
